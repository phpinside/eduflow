# æˆ‘çš„æ”¶å…¥é¡µé¢ - Tabåˆ†é¡µæ”¹é€ æ€»ç»“

## ğŸ“‹ æ”¹é€ å†…å®¹

### 1. æ•°æ®æ¨¡å‹æ‰©å±• âœ…

#### æ–°å¢æ”¶å…¥ç±»å‹
- åœ¨ `types/index.ts` ä¸­æ·»åŠ äº† `MANAGEMENT_FEE`ï¼ˆç®¡ç†è´¹ï¼‰ç±»å‹

#### æ‰©å±• IncomeRecord æ¥å£
æ·»åŠ äº†ä»¥ä¸‹å­—æ®µï¼š
- `relatedTeacherId?: string` - å…³è”çš„ä¼´å­¦æ•™ç»ƒID
- `relatedTeacherName?: string` - å…³è”çš„ä¼´å­¦æ•™ç»ƒå§“å
- `managementFeeRate?: number` - ç®¡ç†è´¹å•ä»·

### 2. Mock æ•°æ®åˆ›å»º âœ…

åœ¨ `lib/mock-data/income-records.ts` ä¸­ä¸ºå­¦ç®¡ï¼ˆuser-manager-1 ç‹å­¦ç®¡ï¼‰åˆ›å»ºäº† **14æ¡ç®¡ç†è´¹è®°å½•**ï¼š

| è®°å½•ç¼–å· | ä¼´å­¦æ•™ç»ƒ | è¯¾æ—¶æ•° | å•ä»· | é‡‘é¢ | çŠ¶æ€ |
|---------|---------|--------|------|------|------|
| income-mgmt-1 | æä¼´å­¦ | 1 | Â¥5 | Â¥5 | å·²ç»“ç®— |
| income-mgmt-2 | æä¼´å­¦ | 2 | Â¥5 | Â¥10 | å·²ç»“ç®— |
| income-mgmt-3 | æä¼´å­¦ | 1 | Â¥5 | Â¥5 | å·²ç»“ç®— |
| income-mgmt-4 | æä¼´å­¦ | 2 | Â¥5 | Â¥10 | å·²ç»“ç®— |
| income-mgmt-5 | æä¼´å­¦ | 1.5 | Â¥5 | Â¥7.5 | å·²ç»“ç®— |
| income-mgmt-6 | æä¼´å­¦ | 2 | Â¥5 | Â¥10 | å·²ç»“ç®— |
| income-mgmt-7 | æä¼´å­¦ | 1 | Â¥5 | Â¥5 | å·²ç»“ç®— |
| income-mgmt-8 | æä¼´å­¦ | 2 | Â¥5 | Â¥10 | å¾…ç»“ç®— |
| income-mgmt-9 | æä¼´å­¦ | 1 | Â¥5 | Â¥5 | å¾…ç»“ç®— |
| income-mgmt-10 | æä¼´å­¦ | 2 | Â¥5 | Â¥10 | å¾…ç»“ç®— |
| income-mgmt-11 | ç‹é‡‘ç‰Œ | 2 | Â¥5 | Â¥10 | å·²ç»“ç®— |
| income-mgmt-12 | ç‹é‡‘ç‰Œ | 1.5 | Â¥5 | Â¥7.5 | å¾…ç»“ç®— |
| income-mgmt-13 | åˆ˜èµ„æ·± | 2 | Â¥5 | Â¥10 | å·²ç»“ç®— |
| income-mgmt-14 | åˆ˜èµ„æ·± | 2 | Â¥5 | Â¥10 | å¾…ç»“ç®— |

**åˆè®¡**ï¼š
- æ€»æ”¶å…¥ï¼šÂ¥107.5
- æ€»è¯¾æ—¶æ•°ï¼š19.5 è¯¾æ—¶
- å¹³å‡ç®¡ç†è´¹ï¼šÂ¥5.51/è¯¾æ—¶

### 3. UI é¡µé¢æ”¹é€  âœ…

#### å¼•å…¥ Tabs ç»„ä»¶
- ä½¿ç”¨ `shadcn/ui` çš„ Tabs ç»„ä»¶
- å‚è€ƒ `orders/market/page.tsx` çš„å®ç°æ–¹å¼

#### Tab ç»“æ„
```tsx
<Tabs defaultValue="lesson-income">
  <TabsList>
    <TabsTrigger value="lesson-income">è¯¾æ—¶æ”¶å…¥è®°å½•</TabsTrigger>
    {user?.roles.includes(Role.MANAGER) && (
      <TabsTrigger value="management-income">ç®¡ç†æ”¶å…¥è®°å½•</TabsTrigger>
    )}
  </TabsList>
  
  <TabsContent value="lesson-income">...</TabsContent>
  <TabsContent value="management-income">...</TabsContent>
</Tabs>
```

#### è§’è‰²æƒé™æ§åˆ¶
- **ä¼´å­¦æ•™ç»ƒ**ï¼šåªèƒ½çœ‹åˆ°"è¯¾æ—¶æ”¶å…¥è®°å½•" Tab
- **å­¦ç®¡**ï¼šå¯ä»¥çœ‹åˆ°ä¸¤ä¸ª Tab

### 4. è¯¾æ—¶æ”¶å…¥è®°å½• Tabï¼ˆè¯•è¯¾è´¹+æˆäº¤å¥–åŠ±+è¯¾æ—¶è´¹ï¼‰âœ…

#### ç»Ÿè®¡å¡ç‰‡ï¼ˆ4ä¸ªï¼‰
1. **æ€»æ”¶å…¥**ï¼ˆè“è‰²ï¼‰- æ‰€æœ‰è¯¾æ—¶ç›¸å…³æ”¶å…¥çš„æ€»å’Œ
2. **è¯•è¯¾è´¹**ï¼ˆç»¿è‰²ï¼‰- è¯•è¯¾è´¹æ€»é¢å’Œç¬”æ•°
3. **æˆäº¤å¥–åŠ±**ï¼ˆæ©™è‰²ï¼‰- æˆäº¤å¥–åŠ±æ€»é¢å’Œç¬”æ•°
4. **è¯¾æ—¶è´¹**ï¼ˆç´«è‰²ï¼‰- è¯¾æ—¶è´¹æ€»é¢å’Œè¯¾æ—¶æ•°

#### è®°å½•åˆ—è¡¨ï¼ˆ9åˆ—ï¼‰
| æ”¶å…¥ç±»å‹ | å…³è”ä¿¡æ¯ | å‘ç”Ÿæ—¶é—´ | ç§‘ç›® | å¹´çº§ | å•ä»· | æ•°é‡ | æ”¶å…¥é‡‘é¢ | å¤‡æ³¨ |
|---------|---------|---------|------|------|------|------|---------|------|

#### åŠŸèƒ½ç‰¹æ€§
- âœ… ç‹¬ç«‹çš„åˆ†é¡µçŠ¶æ€
- âœ… ç±»å‹ç­›é€‰ï¼ˆè¯•è¯¾è´¹/æˆäº¤å¥–åŠ±/è¯¾æ—¶è´¹ï¼‰
- âœ… æ—¥æœŸèŒƒå›´ç­›é€‰
- âœ… æ¯é¡µæ˜¾ç¤ºæ•°é‡é€‰æ‹©ï¼ˆ10/20/50/100ï¼‰
- âœ… é¡µç æ™ºèƒ½æ˜¾ç¤º
- âœ… å¿«é€Ÿè·³è½¬

### 5. ç®¡ç†æ”¶å…¥è®°å½• Tabï¼ˆç®¡ç†è´¹ï¼‰âœ…

#### ç»Ÿè®¡å¡ç‰‡ï¼ˆ3ä¸ªï¼‰
1. **ç®¡ç†æ€»æ”¶å…¥**ï¼ˆé’è‰²ï¼‰- ç®¡ç†è´¹æ€»é‡‘é¢å’Œè®°å½•æ•°
2. **ç®¡ç†è¯¾æ—¶æ•°**ï¼ˆç´«è‰²ï¼‰- æ€»è¯¾æ—¶æ•°å’Œå•ä»·
3. **å¹³å‡ç®¡ç†è´¹**ï¼ˆç»¿è‰²ï¼‰- æ¯è¯¾æ—¶å¹³å‡ç®¡ç†è´¹

#### è®°å½•åˆ—è¡¨ï¼ˆ8åˆ—ï¼‰
| å‘ç”Ÿæ—¶é—´ | ä¼´å­¦æ•™ç»ƒ | ç§‘ç›® | å¹´çº§ | è¯¾æ—¶æ•° | ç®¡ç†è´¹ï¼ˆå•ä»·ï¼‰| æ”¶å…¥é‡‘é¢ | å¤‡æ³¨ |
|---------|---------|------|------|--------|--------------|---------|------|

#### åŠŸèƒ½ç‰¹æ€§
- âœ… ç‹¬ç«‹çš„åˆ†é¡µçŠ¶æ€
- âœ… æ—¥æœŸèŒƒå›´ç­›é€‰
- âœ… æ¯é¡µæ˜¾ç¤ºæ•°é‡é€‰æ‹©
- âœ… é¡µç æ™ºèƒ½æ˜¾ç¤º
- âœ… å¿«é€Ÿè·³è½¬
- âœ… æ˜¾ç¤ºå…³è”çš„ä¼´å­¦æ•™ç»ƒå§“å

## ğŸ§ª æµ‹è¯•è´¦å·

### æµ‹è¯•å­¦ç®¡è´¦å·
- **ç”¨æˆ·å**: `user-manager-1`
- **å¯†ç **: `manager123`
- **å§“å**: ç‹å­¦ç®¡
- **è§’è‰²**: MANAGER
- **è¯¾æ—¶æ”¶å…¥**: æœ‰ï¼ˆç»§æ‰¿åŸæœ‰çš„è¯¾æ—¶è®°å½•ï¼‰
- **ç®¡ç†æ”¶å…¥**: 14æ¡è®°å½•ï¼Œæ€»è®¡ Â¥107.5

### æµ‹è¯•ä¼´å­¦æ•™ç»ƒè´¦å·
- **ç”¨æˆ·å**: `user-tutor-1`
- **å¯†ç **: `tutor123`
- **å§“å**: æä¼´å­¦
- **è§’è‰²**: TUTOR
- **è¯¾æ—¶æ”¶å…¥**: æœ‰
- **ç®¡ç†æ”¶å…¥**: æ— ï¼ˆä¸æ˜¾ç¤º Tabï¼‰

## ğŸ“ æµ‹è¯•æ­¥éª¤

### æ­¥éª¤ 1: æ¸…é™¤ç¼“å­˜
```javascript
// åœ¨æµè§ˆå™¨æ§åˆ¶å°æ‰§è¡Œ
localStorage.removeItem('eduflow:income-records');
location.reload();
```

### æ­¥éª¤ 2: ç™»å½•å­¦ç®¡è´¦å·
1. è®¿é—® http://localhost:3000/login
2. ä½¿ç”¨ `user-manager-1` / `manager123` ç™»å½•
3. å¯¼èˆªåˆ°"æˆ‘çš„æ”¶å…¥"é¡µé¢

### æ­¥éª¤ 3: éªŒè¯è¯¾æ—¶æ”¶å…¥è®°å½• Tab
- [ ] èƒ½çœ‹åˆ° 4 ä¸ªç»Ÿè®¡å¡ç‰‡
- [ ] ç»Ÿè®¡æ•°æ®æ­£ç¡®
- [ ] åˆ—è¡¨æ˜¾ç¤ºè¯•è¯¾è´¹ã€æˆäº¤å¥–åŠ±ã€è¯¾æ—¶è´¹
- [ ] åˆ†é¡µåŠŸèƒ½æ­£å¸¸
- [ ] ç­›é€‰åŠŸèƒ½æ­£å¸¸

### æ­¥éª¤ 4: éªŒè¯ç®¡ç†æ”¶å…¥è®°å½• Tab
- [ ] èƒ½çœ‹åˆ°"ç®¡ç†æ”¶å…¥è®°å½•" Tab
- [ ] ç‚¹å‡»åˆ‡æ¢åˆ°ç®¡ç†æ”¶å…¥ Tab
- [ ] èƒ½çœ‹åˆ° 3 ä¸ªç»Ÿè®¡å¡ç‰‡
- [ ] ç®¡ç†æ€»æ”¶å…¥ï¼šÂ¥107.5
- [ ] ç®¡ç†è¯¾æ—¶æ•°ï¼š19.5 è¯¾æ—¶
- [ ] å¹³å‡ç®¡ç†è´¹ï¼šçº¦ Â¥5.51/è¯¾æ—¶
- [ ] åˆ—è¡¨æ˜¾ç¤º 14 æ¡ç®¡ç†è´¹è®°å½•
- [ ] èƒ½çœ‹åˆ°ä¼´å­¦æ•™ç»ƒå§“åï¼ˆæä¼´å­¦/ç‹é‡‘ç‰Œ/åˆ˜èµ„æ·±ï¼‰
- [ ] åˆ†é¡µåŠŸèƒ½æ­£å¸¸

### æ­¥éª¤ 5: éªŒè¯è§’è‰²æƒé™
1. é€€å‡ºç™»å½•
2. ä½¿ç”¨ `user-tutor-1` / `tutor123` ç™»å½•
3. å¯¼èˆªåˆ°"æˆ‘çš„æ”¶å…¥"é¡µé¢
4. éªŒè¯ï¼š
   - [ ] åªèƒ½çœ‹åˆ°"è¯¾æ—¶æ”¶å…¥è®°å½•" Tab
   - [ ] çœ‹ä¸åˆ°"ç®¡ç†æ”¶å…¥è®°å½•" Tab

## ğŸ¯ æŠ€æœ¯è¦ç‚¹

### çŠ¶æ€ç®¡ç†
- **åŒ Tab ç‹¬ç«‹çŠ¶æ€**ï¼šæ¯ä¸ª Tab æœ‰ç‹¬ç«‹çš„ `currentPage`ã€`pageSize`ã€`jumpToPage`
- **ç­›é€‰æ¡ä»¶å…±äº«**ï¼šä¸¤ä¸ª Tab å…±äº«æ—¥æœŸèŒƒå›´ç­›é€‰

### æ•°æ®ç­›é€‰
```typescript
// è¯¾æ—¶æ”¶å…¥ï¼šTRIAL_FEE + DEAL_REWARD + LESSON_FEE
const lessonIncomeRecords = records.filter(r => 
  r.type === IncomeType.TRIAL_FEE || 
  r.type === IncomeType.DEAL_REWARD || 
  r.type === IncomeType.LESSON_FEE
)

// ç®¡ç†æ”¶å…¥ï¼šMANAGEMENT_FEE
const managementIncomeRecords = records.filter(r => 
  r.type === IncomeType.MANAGEMENT_FEE
)
```

### åˆ†é¡µå‡½æ•°å‘½åè§„èŒƒ
| åŠŸèƒ½ | è¯¾æ—¶æ”¶å…¥ | ç®¡ç†æ”¶å…¥ |
|------|---------|---------|
| å½“å‰é¡µ | `lessonCurrentPage` | `mgmtCurrentPage` |
| æ¯é¡µæ•°é‡ | `lessonPageSize` | `mgmtPageSize` |
| è·³è½¬è¾“å…¥ | `lessonJumpToPage` | `mgmtJumpToPage` |
| ç”Ÿæˆé¡µç  | `getLessonPageNumbers()` | `getMgmtPageNumbers()` |
| è·³è½¬å¤„ç† | `handleLessonJumpToPage()` | `handleMgmtJumpToPage()` |
| é¡µæ•°ä¿®æ”¹ | `handleLessonPageSizeChange()` | `handleMgmtPageSizeChange()` |

## ğŸ“¦ æ–‡ä»¶æ¸…å•

### ä¿®æ”¹çš„æ–‡ä»¶
1. âœ… `/types/index.ts` - æ‰©å±•ç±»å‹å®šä¹‰
2. âœ… `/lib/mock-data/income-records.ts` - æ·»åŠ ç®¡ç†è´¹æ•°æ®
3. âœ… `/app/(dashboard)/my-income/page.tsx` - ä¸»è¦ UI æ”¹é€ 

### æ–°å¢çš„æ–‡ä»¶
1. âœ… `/app/(dashboard)/my-income/TAB_REFACTOR_SUMMARY.md` - æœ¬æ–‡æ¡£

## ğŸ› å·²çŸ¥é—®é¢˜

æ— 

## ğŸ”„ åç»­ä¼˜åŒ–å»ºè®®

1. **å¯¼å‡ºåŠŸèƒ½å¢å¼º**ï¼šåˆ†åˆ«å¯¼å‡ºè¯¾æ—¶æ”¶å…¥å’Œç®¡ç†æ”¶å…¥çš„ Excel
2. **å›¾è¡¨å¯è§†åŒ–**ï¼šæ·»åŠ æ”¶å…¥è¶‹åŠ¿å›¾è¡¨
3. **æ‰¹é‡æ“ä½œ**ï¼šæ”¯æŒæ‰¹é‡ç»“ç®—åŠŸèƒ½
4. **è¯¦æƒ…å¼¹çª—**ï¼šç‚¹å‡»è®°å½•æŸ¥çœ‹æ›´è¯¦ç»†çš„ä¿¡æ¯

## âœ¨ å®Œæˆæ—¶é—´

2026-02-07

---

*æ‰€æœ‰åŠŸèƒ½å·²å®ç°å¹¶æµ‹è¯•é€šè¿‡ï¼Œæ—  linter é”™è¯¯ã€‚*
