# 我的收入功能 - 测试账号说明

## 📋 可用测试账号

### 伴学教练 (TUTOR) 账号

#### 1️⃣ 李伴学（数据最全，推荐测试）
- **手机号**: `13800002001`
- **用户ID**: `user-tutor-1`
- **收入数据**:
  - 试课费: 5笔 (总额 ¥1,000)
    - 已结算: 2笔 (¥400)
    - 待结算: 3笔 (¥600)
  - 成交奖励: 3笔 (总额 ¥140)
    - 已结算: 2笔 (¥80)
    - 待结算: 1笔 (¥60)
  - 课时费: 10笔 (总额 ¥2,475，16.5课时)
    - 已结算: 7笔 (¥1,725，11.5课时)
    - 待结算: 3笔 (¥750，5课时)
  - **总收入**: ¥3,615

#### 2️⃣ 王金牌
- **手机号**: `13800002002`
- **用户ID**: `user-tutor-2`
- **收入数据**:
  - 试课费: 2笔 (总额 ¥400)
    - 已结算: 1笔 (¥200)
    - 待结算: 1笔 (¥200)
  - 成交奖励: 1笔 (总额 ¥50)
    - 已结算: 1笔 (¥50)
  - 课时费: 2笔 (总额 ¥700，3.5课时)
    - 已结算: 1笔 (¥400，2课时)
    - 待结算: 1笔 (¥300，1.5课时)
  - **总收入**: ¥1,150
  - **总记录数**: 5条

#### 3️⃣ 刘资深
- **手机号**: `13800002003`
- **用户ID**: `user-tutor-3`
- **收入数据**:
  - 试课费: 1笔 (总额 ¥200)
    - 已结算: 1笔 (¥200)
  - 成交奖励: 1笔 (总额 ¥60)
    - 已结算: 1笔 (¥60)
  - 课时费: 2笔 (总额 ¥880，4课时)
    - 已结算: 1笔 (¥440，2课时)
    - 待结算: 1笔 (¥440，2课时)
  - **总收入**: ¥1,140

### 学管 (MANAGER) 账号

#### 4️⃣ 王学管
- **手机号**: `13800003001`
- **用户ID**: `user-manager-1`
- **收入数据**:
  - 试课费: 1笔 (总额 ¥200)
    - 待结算: 1笔 (¥200)
  - 课时费: 3笔 (总额 ¥990，5.5课时)
    - 已结算: 2笔 (¥630，3.5课时)
    - 待结算: 1笔 (¥360，2课时)
  - **总收入**: ¥1,190

## 🧪 测试步骤

### 步骤 1: 清除旧数据（首次使用或数据异常时）

打开浏览器控制台 (F12)，执行以下代码：

```javascript
// 清除收入记录数据
localStorage.removeItem('eduflow:income-records');

// 或清除所有eduflow数据重新初始化
Object.keys(localStorage).forEach(key => {
  if (key.startsWith('eduflow:')) {
    localStorage.removeItem(key);
  }
});

// 刷新页面
location.reload();
```

### 步骤 2: 登录测试账号

1. 访问登录页面
2. 输入上述任一手机号（无需密码，开发环境）
3. 系统会自动登录

### 步骤 3: 访问"我的收入"页面

- 方式1: 在左侧导航栏点击 "我的收入" 菜单（钱包图标）
- 方式2: 直接访问 `http://localhost:3000/my-income`

### 步骤 4: 验证功能

#### ✅ 默认加载验证
- 页面应自动加载本月（2025年2月）的数据
- 统计卡片应显示正确的金额

#### ✅ 伴学教练（李伴学）预期结果
登录后应看到：
- 总收入: ¥1,410（本月数据）
- 试课费: ¥600（3笔）
- 成交奖励: ¥60（1笔）
- 课时费: ¥750（3笔，5课时）
- 记录列表: 7条记录

#### ✅ 学管（王学管）预期结果
登录后应看到：
- 总收入: ¥560（本月数据）
- 试课费: ¥200（1笔）
- 成交奖励: ¥0（0笔）
- 课时费: ¥360（1笔，2课时）
- 记录列表: 2条记录

#### ✅ 筛选功能验证
1. **快捷选择-本月**: 显示2025年2月数据
2. **快捷选择-上月**: 显示2025年1月数据
3. **快捷选择-近三月**: 显示2024年12月-2025年2月数据
4. **记录类型-仅试课费**: 只显示试课费记录
5. **记录类型-仅成交奖励**: 只显示成交奖励记录
6. **记录类型-仅课时费**: 只显示课时费记录

#### ✅ 其他功能验证
- 刷新按钮: 点击后显示Toast提示
- 导出按钮: 点击后显示"开发中"提示
- 分页: 超过20条记录时显示分页控件
- 查看详情: 课时费记录的操作列有"眼睛"图标

## 🔍 数据验证

### 验证数据完整性

在浏览器控制台执行以下代码，查看存储的收入数据：

```javascript
// 查看所有收入记录
const records = JSON.parse(localStorage.getItem('eduflow:income-records') || '[]');
console.log('总记录数:', records.length);

// 按用户统计
const byUser = records.reduce((acc, r) => {
  acc[r.teacherId] = (acc[r.teacherId] || 0) + 1;
  return acc;
}, {});
console.log('各用户记录数:', byUser);

// 预期结果:
// {
//   "user-tutor-1": 18,
//   "user-tutor-2": 5,
//   "user-tutor-3": 4,
//   "user-manager-1": 4
// }
```

### 验证用户过滤

在"我的收入"页面，打开控制台：

```javascript
// 查看当前用户ID
console.log('当前用户:', localStorage.getItem('eduflow:currentUserId'));

// 查看筛选后的记录数
// 应该只显示当前用户的记录
```

## ❗ 常见问题

### Q1: 登录后看不到收入数据
**原因**: localStorage 中已有旧数据
**解决**: 清除 `eduflow:income-records` 键，刷新页面

### Q2: 统计金额为 ¥0
**原因**: 日期筛选条件不包含数据时间范围
**解决**: 
- 点击"近三月"快捷按钮
- 或手动选择 2025-01-01 至 2025-02-28

### Q3: 显示其他用户的数据
**原因**: 用户身份未正确设置
**解决**: 
- 退出登录
- 重新使用正确的手机号登录

### Q4: 页面空白或报错
**原因**: 可能是类型导入或组件错误
**解决**: 
1. 检查浏览器控制台错误信息
2. 确认所有文件已正确保存
3. 重启开发服务器

## 📊 测试用例表

| 测试项 | 账号 | 操作 | 预期结果 |
|--------|------|------|----------|
| 默认加载 | 李伴学 | 登录进入页面 | 显示本月7条记录 |
| 筛选-本月 | 李伴学 | 点击"本月" | 显示2025年2月数据 |
| 筛选-上月 | 李伴学 | 点击"上月" | 显示2025年1月数据 |
| 筛选-试课费 | 李伴学 | 选择"仅试课费" | 只显示5条试课费记录 |
| 筛选-成交奖励 | 李伴学 | 选择"仅成交奖励" | 只显示3条成交奖励 |
| 筛选-课时费 | 李伴学 | 选择"仅课时费" | 只显示10条课时费 |
| 统计准确性 | 李伴学 | 查看统计卡片 | 本月总收入¥1,410 |
| 用户隔离 | 王金牌 | 登录后查看 | 只显示自己的5条记录 |
| 学管角色 | 王学管 | 登录后查看 | 能正常访问，显示4条记录 |
| 空状态 | 新用户 | 登录后查看 | 显示"暂无收入记录" |

## ✅ 验证清单

使用以下清单验证功能：

- [ ] 伴学教练（李伴学）能看到18条记录
- [ ] 伴学教练（王金牌）能看到5条记录
- [ ] 伴学教练（刘资深）能看到4条记录
- [ ] 学管（王学管）能看到4条记录
- [ ] 统计卡片显示正确金额
- [ ] 日期筛选功能正常
- [ ] 类型筛选功能正常
- [ ] 快捷日期选择正常
- [ ] 分页功能正常
- [ ] 用户只能看到自己的数据
- [ ] 刷新功能正常
- [ ] 页面无报错

## 🎯 推荐测试流程

1. **首次测试** - 使用李伴学账号（数据最全）
2. **权限测试** - 切换到王学管账号（验证学管角色）
3. **筛选测试** - 使用李伴学账号测试各种筛选条件
4. **边界测试** - 使用没有数据的教练账号（如 user-tutor-4）

---

**最后更新**: 2025-02-07
**Mock 数据版本**: v1.0
**总记录数**: 31条
