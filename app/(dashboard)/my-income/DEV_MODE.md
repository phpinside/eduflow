# 我的收入页面 - 开发模式说明

## 🔧 开发模式配置

为了方便研发人员查看所有Mock数据，"我的收入"页面已配置为**开发模式**。

### 主要变更

#### 1. 默认显示所有数据
```typescript
// 原来：默认显示本月数据
dateRange: {
  start: startOfMonth(new Date()),
  end: endOfDay(new Date())
}

// 现在：默认显示所有数据（2020-2030）
dateRange: {
  start: new Date('2020-01-01'),
  end: new Date('2030-12-31')
}
```

#### 2. 忽略日期筛选限制
- 默认日期范围设置为 2020-2030，涵盖所有Mock数据
- 用户仍可手动修改日期进行筛选
- 类型筛选功能保持正常

#### 3. UI 提示更新
- 页面标题显示"开发模式：默认显示所有数据"
- 筛选区顶部显示黄色提示框，标注当前记录数
- 统计卡片显示实际记录数量
- 添加"🔧 显示全部"快捷按钮

### 当前显示效果

登录后页面将显示：

```
┌────────────────────────────────────────────────┐
│ 🔧 开发模式: 当前显示所有时间范围的数据         │
│    （共 18 条记录）- 以李伴学为例               │
└────────────────────────────────────────────────┘

┌─────────────┬─────────────┬─────────────┬─────────────┐
│ 总收入       │ 试课费       │ 成交奖励     │ 课时费       │
│ ¥3,615      │ ¥1,000      │ ¥140        │ ¥2,475      │
│ (18条记录)  │ 5笔·¥200/次 │ 3笔·按规则   │ 16.5课时     │
└─────────────┴─────────────┴─────────────┴─────────────┘
```

### 测试账号数据

| 用户 | 手机号 | 总记录数 | 总收入 |
|------|--------|----------|--------|
| 李伴学 | 13800002001 | 18条 | ¥3,615 |
| 王金牌 | 13800002002 | 5条 | ¥1,150 |
| 刘资深 | 13800002003 | 4条 | ¥1,140 |
| 王学管 | 13800003001 | 4条 | ¥1,190 |

### 调试信息

页面加载时会在浏览器控制台输出调试信息：

```javascript
📊 收入数据调试信息:
- 总记录数: 31
- 当前用户ID: user-tutor-1
- 当前用户名: 李伴学
- 我的记录数: 18
- 第一条记录: {...}
```

### 如果看不到数据

#### 原因分析
localStorage 中可能存在旧的数据格式或缓存

#### 解决方案
在浏览器控制台 (F12) 执行：

```javascript
// 方案1: 清除收入记录
localStorage.removeItem('eduflow:income-records');
location.reload();

// 方案2: 清除所有eduflow数据
Object.keys(localStorage).forEach(key => {
  if (key.startsWith('eduflow:')) {
    localStorage.removeItem(key);
  }
});
location.reload();
```

### 功能测试

#### 快捷选择测试
1. **🔧 显示全部** - 显示所有数据（18条）
2. **本月** - 显示2025年2月数据（7条）
3. **上月** - 显示2025年1月数据（11条）
4. **近三月** - 显示近三个月数据（18条）

#### 类型筛选测试
- **全部** - 显示所有类型（18条）
- **仅试课费** - 只显示试课费（5条）
- **仅成交奖励** - 只显示成交奖励（3条）
- **仅课时费** - 只显示课时费（10条）

### 生产环境建议

在生产环境部署时，建议：

1. **恢复正常日期范围**
```typescript
dateRange: {
  start: startOfMonth(new Date()),  // 本月第一天
  end: endOfDay(new Date())         // 今天
}
```

2. **移除开发提示**
- 删除黄色提示框
- 更新页面标题描述
- 移除"🔧 显示全部"按钮（或改为"显示全部历史"）

3. **保留调试信息**
- 可以用环境变量控制是否输出 console.log
```typescript
if (process.env.NODE_ENV === 'development') {
  console.log('📊 收入数据调试信息:', ...)
}
```

### 环境变量配置（可选）

可以创建环境变量来控制开发模式：

```env
# .env.local
NEXT_PUBLIC_DEV_MODE=true
```

```typescript
// 在代码中使用
const isDevMode = process.env.NEXT_PUBLIC_DEV_MODE === 'true'

const [filters, setFilters] = useState({
  dateRange: isDevMode 
    ? { start: new Date('2020-01-01'), end: new Date('2030-12-31') }
    : { start: startOfMonth(new Date()), end: endOfDay(new Date()) },
  incomeType: 'all'
})
```

---

**最后更新**: 2025-02-07  
**配置状态**: ✅ 开发模式已启用  
**目的**: 方便研发人员查看所有Mock数据
